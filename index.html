<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø¨Ø±Ù‚Ú©Ø§Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600&display=swap');
        body { font-family: 'Vazirmatn', sans-serif; background: #f1f5f9; color: #334155; min-height: 100vh; margin: 0; }
        .container { max-width: 960px; margin: 0 auto; padding: 1rem; }
        .card { background: white; border-radius: 1rem; padding: 1.8rem; margin-bottom: 2rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { font-size: 2rem; font-weight: 600; text-align: center; color: #1e40af; margin: 2rem 0 1.5rem; }
        h2 { font-size: 1.4rem; font-weight: 600; color: #1e40af; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
        label { font-weight: 500; color: #475569; font-size: 1rem; margin-bottom: 0.5rem; display: block; }
        input[type="text"], textarea { width: 100%; padding: 0.8rem 1rem; border: 1.5px solid #cbd5e1; border-radius: 0.75rem; background: #f8fafc; font-size: 1rem; }
        input:focus, textarea:focus { outline: none; border-color: #3b82f6; }
        .radio-group { display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 0.5rem; }
        .radio-item { display: flex; align-items: center; gap: 0.6rem; background: #eff6ff; padding: 0.7rem 1.2rem; border-radius: 1rem; font-size: 1rem; }
        button { background: linear-gradient(to right, #2563eb, #3b82f6); color: white; padding: 1rem 3rem; border-radius: 1.5rem; font-weight: 600; font-size: 1.2rem; box-shadow: 0 8px 25px rgba(59,130,246,0.4); transition: all 0.3s; margin: 1rem; }
        button:hover { transform: translateY(-4px); box-shadow: 0 12px 35px rgba(59,130,246,0.5); }
        .clear-btn { background: linear-gradient(to right, #dc2626, #ef4444); }
        table { width: 100%; border-collapse: separate; border-spacing: 0 0.8rem; }
        th { background: #dbeafe; padding: 0.9rem; text-align: center; font-weight: 600; font-size: 1rem; border-radius: 1rem; }
        td { background: #f8fafc; padding: 0.9rem; border-radius: 1rem; }
        .history-item { background: #f8fafc; padding: 1.5rem; border-radius: 1rem; border-right: 5px solid #3b82f6; cursor: pointer; margin-bottom: 1rem; }
        .total-input { background: #dbeafe; font-weight: 600; color: #1e40af; text-align: center; }
        .alert { background: #fee2e2; color: #991b1b; padding: 1rem; border-radius: 1rem; font-weight: 600; border-right: 4px solid #ef4444; }
        @media (max-width: 768px) {
            .container { padding: 0.8rem; }
            .card { padding: 1.5rem; }
            h1 { font-size: 1.8rem; }
            h2 { font-size: 1.3rem; }
            button { padding: 0.9rem 2.5rem; font-size: 1.1rem; margin: 0.8rem; }
            .radio-item { padding: 0.6rem 1rem; font-size: 0.95rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ÙØ±Ù… Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø¨Ø±Ù‚Ú©Ø§Ø±</h1>

        <form id="evaluation-form" class="card">
            <!-- ØªÙ…Ø§Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§ Ù…Ø«Ù„ Ù‚Ø¨Ù„ -->

            <div class="text-center mt-16">
                <button type="button" id="save-and-pdf-btn">Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯ PDF</button>
                <button type="button" id="clear-all" class="clear-btn">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
            </div>
        </form>

        <div class="card">
            <h2>ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒâ€ŒÙ‡Ø§</h2>
            <div id="history-list" class="space-y-5"></div>
        </div>
    </div>

    <script>
        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª
        function updateDateTime() {
            const field = document.getElementById('visit_datetime');
            if (field) {
                const now = new Date();
                field.value = now.toLocaleString('fa-IR');
            }
        }
        updateDateTime();
        setInterval(updateDateTime, 1000);

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª
        function calculateScores() {
            let s3 = 0;
            for (let i = 1; i <= 5; i++) {
                const checked = document.querySelector(`input[name="tech${i}"]:checked`);
                if (checked) s3 += parseInt(checked.value);
            }
            document.getElementById('section3_total').value = s3;

            let s4 = 0;
            for (let i = 1; i <= 4; i++) {
                const checked = document.querySelector(`input[name="rule${i}"]:checked`);
                if (checked) s4 += parseInt(checked.value);
            }
            document.getElementById('section4_total').value = s4;

            const quality = document.querySelector('input[name="quality"]:checked');
            document.getElementById('section5_total').value = quality ? parseInt(quality.value) : 0;

            const exp = document.querySelector('input[name="exp_level"]:checked');
            document.getElementById('section6_total').value = exp ? parseInt(exp.value) : 0;

            let s7 = 0;
            ['cooperation', 'behavior', 'complaint'].forEach(name => {
                const checked = document.querySelector(`input[name="${name}"]:checked`);
                if (checked) s7 += parseInt(checked.value);
            });
            document.getElementById('section7_total').value = s7;

            const total = s3 + s4 + (quality ? parseInt(quality.value) : 0) + (exp ? parseInt(exp.value) : 0) + s7;
            document.getElementById('total_score').value = total;
        }

        document.addEventListener('change', (e) => {
            if (e.target.type === 'radio') calculateScores();
        });

        // Ø°Ø®ÛŒØ±Ù‡ + Ø³Ø§Ø®Øª PDF Ø®ÙˆØ´Ú¯Ù„
        function saveAndDownloadPDF() {
            calculateScores();

            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡
            const data = {
                electrician_name: document.getElementById('electrician_name').value.trim() || 'Ù†Ø§Ù…Ø´Ø®Øµ',
                total_score: document.getElementById('total_score').value,
                rank: document.querySelector('input[name="rank"]:checked')?.value || 'â€”',
                timestamp: new Date().toLocaleString('fa-IR'),
                fullData: {}
            };

            document.querySelectorAll('#evaluation-form input[type="text"], #evaluation-form textarea').forEach(el => {
                data.fullData[el.id] = el.value;
            });
            document.querySelectorAll('#evaluation-form input[type="radio"]:checked').forEach(el => {
                data.fullData[el.name] = el.value;
            });

            let history = JSON.parse(localStorage.getItem('evaluations') || '[]');
            history.unshift(data);
            localStorage.setItem('evaluations', JSON.stringify(history));
            loadHistory();

            // Ø³Ø§Ø®Øª PDF Ø®ÙˆØ´Ú¯Ù„ Ùˆ Ø±Ø³Ù…ÛŒ
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            pdf.setFont('helvetica'); // ÙÙˆÙ†Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
            pdf.setFontSize(18);
            pdf.text('ÙØ±Ù… Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø¨Ø±Ù‚Ú©Ø§Ø±', 105, 20, { align: 'center' });

            pdf.setFontSize(12);
            let y = 35;

            // Ø¨Ø®Ø´ Û±
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û± | Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            pdf.text(`Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø¨Ø±Ù‚Ú©Ø§Ø±: ${data.fullData.electrician_name || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`Ú©Ø¯ Ø¹Ø¶ÙˆÛŒØª / Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: ${data.fullData.membership_code || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`Ù†Ø´Ø§Ù†ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ù…ÙˆØ±Ø¯ Ø¨Ø§Ø²Ø¯ÛŒØ¯: ${data.fullData.project_address || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`Ù†ÙˆØ¹ Ù¾Ø±ÙˆÚ˜Ù‡: ${data.fullData.project_type || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡: ${data.fullData.project_status || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª Ø¨Ø§Ø²Ø¯ÛŒØ¯: ${data.fullData.visit_datetime || 'â€”'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û²
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û² | Ù…Ø´Ø®ØµØ§Øª Ø§Ø±Ø²ÛŒØ§Ø¨Ø§Ù†', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            pdf.text(`Ù†Ø§Ù… Ø§Ø±Ø²ÛŒØ§Ø¨ Ø§ÙˆÙ„: ${data.fullData.evaluator1_name || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`Ù†Ø§Ù… Ø§Ø±Ø²ÛŒØ§Ø¨ Ø¯ÙˆÙ…: ${data.fullData.evaluator2_name || 'â€”'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û³
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û³ | Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ ÙÙ†ÛŒ Ùˆ Ø§Ø¬Ø±Ø§ÛŒÛŒ (Û³Û° Ø§Ù…ØªÛŒØ§Ø²)', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            const techLabels = ['Ø±Ø¹Ø§ÛŒØª Ø§ØµÙˆÙ„ Ø³ÛŒÙ…â€ŒÚ©Ø´ÛŒ', 'Ú©ÛŒÙÛŒØª ØªØ§Ø¨Ù„Ùˆ Ø¨Ø±Ù‚', 'Ø§ÛŒÙ…Ù†ÛŒ Ø§Ø¬Ø±Ø§ (Ø§ØªØµØ§Ù„Ø§ØªØŒ Ø§Ø±ØªØŒ Ø­ÙØ§Ø¸Øª)', 'Ù†Ø¸Ù…ØŒ ØªÙ…ÛŒØ²ÛŒ Ùˆ Ø²ÛŒØ¨Ø§ÛŒÛŒ Ú©Ø§Ø±', 'Ø±Ø¹Ø§ÛŒØª Ø­Ø¯Ø§Ù‚Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø¨Ø­Ø« Û±Û³'];
            for (let i = 1; i <= 5; i++) {
                pdf.text(`${i}. ${techLabels[i-1]}: ${data.fullData[`tech${i}`] || 'Û°'} Ø§Ù…ØªÛŒØ§Ø²`, 20, y);
                y += 8;
            }
            pdf.text(`Ø¬Ù…Ø¹ Ø§Ù…ØªÛŒØ§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´: ${data.fullData.section3_total || 'Û°'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û´
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û´ | Ø±Ø¹Ø§ÛŒØª Ù†Ø±Ø®Ù†Ø§Ù…Ù‡ Ùˆ Ø§ØµÙˆÙ„ ØµÙ†ÙÛŒ (Û²Û° Ø§Ù…ØªÛŒØ§Ø²)', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            const ruleLabels = ['Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ÛŒØ§ ØªÙˆØ§ÙÙ‚ Ù…Ø´Ø®Øµ Ø¯Ø§Ø±Ø¯', 'Ù‚ÛŒÙ…Øª Ù…Ø·Ø§Ø¨Ù‚ Ù†Ø±Ø®Ù†Ø§Ù…Ù‡ Ú©Ù…ÛŒØªÙ‡', 'Ø¹Ø¯Ù… Ù‚ÛŒÙ…Øªâ€ŒØ´Ú©Ù†ÛŒ', 'Ø´Ú©Ø§ÛŒØª Ù…Ø§Ù„ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ù†Ø¯Ø§Ø±Ø¯'];
            for (let i = 1; i <= 4; i++) {
                const val = data.fullData[`rule${i}`] === '5' ? 'Ø¨Ù„Ù‡' : 'Ø®ÛŒØ±';
                pdf.text(`${i}. ${ruleLabels[i-1]}: ${val}`, 20, y);
                y += 8;
            }
            pdf.text(`Ø§Ù…ØªÛŒØ§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´: ${data.fullData.section4_total || 'Û°'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Ûµ
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Ûµ | Ú©ÛŒÙÛŒØª Ú©Ù„ÛŒ Ø§Ø¬Ø±Ø§ (Û±Ûµ Ø§Ù…ØªÛŒØ§Ø²)', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            const qualityText = {'0': 'Ø¶Ø¹ÛŒÙ', '5': 'Ù…ØªÙˆØ³Ø·', '10': 'Ø®ÙˆØ¨', '15': 'Ø¹Ø§Ù„ÛŒ'}[data.fullData.quality] || 'â€”';
            pdf.text(`Ú©ÛŒÙÛŒØª Ú©Ù„ÛŒ Ø§Ø¬Ø±Ø§: ${qualityText}`, 20, y);
            y += 8;
            pdf.text(`Ø§Ù…ØªÛŒØ§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´: ${data.fullData.section5_total || 'Û°'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û¶
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û¶ | Ø³Ø§Ø¨Ù‚Ù‡ Ùˆ ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±ÛŒ (Û²Û° Ø§Ù…ØªÛŒØ§Ø²)', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            pdf.text(`Ø³Ø§Ø¨Ù‚Ù‡ Ú©Ø§Ø±ÛŒ Ø§Ø¹Ù„Ø§Ù…â€ŒØ´Ø¯Ù‡: ${data.fullData.experience_years || 'â€”'} Ø³Ø§Ù„`, 20, y);
            y += 8;
            pdf.text(`Ø³Ø·Ø­ ØªØ¬Ø±Ø¨Ù‡: ${data.fullData.exp_level || 'â€”'}`, 20, y);
            y += 8;
            pdf.text(`Ø§Ù…ØªÛŒØ§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´: ${data.fullData.section6_total || 'Û°'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û·
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û· | Ø§Ø¹ØªØ¨Ø§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ Ù‡Ù…Ú©Ø§Ø±ÛŒ ØµÙ†ÙÛŒ (Û±Ûµ Ø§Ù…ØªÛŒØ§Ø²)', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            const coopText = {'0': 'Ø¶Ø¹ÛŒÙ', '3': 'Ù…ØªÙˆØ³Ø·', '5': 'Ø®ÙˆØ¨'}[data.fullData.cooperation] || 'â€”';
            const behaviorText = {'0': 'Ø¶Ø¹ÛŒÙ', '3': 'Ù…ØªÙˆØ³Ø·', '5': 'Ø®ÙˆØ¨'}[data.fullData.behavior] || 'â€”';
            const complaintText = data.fullData.complaint === '5' ? 'Ù†Ø¯Ø§Ø±Ø¯' : 'Ø¯Ø§Ø±Ø¯';
            pdf.text(`Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¨Ø§ Ú©Ù…ÛŒØªÙ‡: ${coopText}`, 20, y);
            y += 8;
            pdf.text(`Ø±ÙØªØ§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¯Ø± Ú©Ø§Ø±Ú¯Ø§Ù‡: ${behaviorText}`, 20, y);
            y += 8;
            pdf.text(`Ø³Ø§Ø¨Ù‚Ù‡ Ø´Ú©Ø§ÛŒØª: ${complaintText}`, 20, y);
            y += 8;
            pdf.text(`Ø§Ù…ØªÛŒØ§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´: ${data.fullData.section7_total || 'Û°'}`, 20, y);
            y += 15;

            // Ø¨Ø®Ø´ Û¸
            pdf.setFontSize(14);
            pdf.text('Ø¨Ø®Ø´ Û¸ | Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ Ù†Ù‡Ø§ÛŒÛŒ', 105, y, { align: 'center' });
            y += 10;
            pdf.setFontSize(12);
            pdf.text(`Ø¬Ù…Ø¹ Ú©Ù„ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª: ${data.fullData.total_score || 'Û°'} Ø§Ø² Û±Û°Û°`, 20, y);
            y += 8;
            pdf.text(`Ø±ØªØ¨Ù‡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ: ${data.fullData.rank || 'â€”'}`, 20, y);
            y += 10;
            pdf.setFontSize(11);
            pdf.text('Ù†Ø¸Ø± ØªÚ©Ù…ÛŒÙ„ÛŒ Ø§Ø±Ø²ÛŒØ§Ø¨Ø§Ù†:', 20, y);
            y += 8;
            const comments = data.fullData.comments || 'â€”';
            const splitComments = pdf.splitTextToSize(comments, 170);
            pdf.text(splitComments, 20, y);
            y += splitComments.length * 7 + 10;

            pdf.setFontSize(10);
            pdf.text(`ØªØ§Ø±ÛŒØ® ØµØ¯ÙˆØ±: ${new Date().toLocaleString('fa-IR')}`, 20, y);

            pdf.save(`Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ_${data.electrician_name}_${new Date().toLocaleDateString('fa-IR')}.pdf`);

            document.getElementById('evaluation-form').reset();
            updateDateTime();
            calculateScores();
            alert('Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ Ùˆ PDF Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯ ğŸ’™');
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ§Ø±ÛŒØ®Ú†Ù‡ (Ù‡Ù…Ø§Ù† Ù‚Ø¨Ù„ÛŒ)
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('evaluations') || '[]');
            const list = document.getElementById('history-list');
            list.innerHTML = '';
            if (history.length === 0) {
                list.innerHTML = '<p class="text-center text-gray-500 py-6">Ù‡Ù†ÙˆØ² Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
                return;
            }
            history.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                        <div>
                            <div class="font-semibold text-lg">${item.electrician_name}</div>
                            <div class="text-gray-600 text-sm mt-1">Ø§Ù…ØªÛŒØ§Ø²: ${item.total_score} | Ø±ØªØ¨Ù‡: ${item.rank} | ${item.timestamp}</div>
                        </div>
                        <div class="flex gap-3">
                            <button class="bg-blue-600 text-white px-6 py-2 rounded-lg" onclick="editEvaluation(${index})">ÙˆÛŒØ±Ø§ÛŒØ´</button>
                            <button class="bg-red-600 text-white px-6 py-2 rounded-lg" onclick="deleteEvaluation(${index})">Ø­Ø°Ù</button>
                        </div>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        window.editEvaluation = function(index) {
            const history = JSON.parse(localStorage.getItem('evaluations') || '[]');
            const data = history[index].fullData;

            document.getElementById('electrician_name').value = data.electrician_name || '';
            document.getElementById('membership_code').value = data.membership_code || '';
            document.getElementById('project_address').value = data.project_address || '';
            document.getElementById('evaluator1_name').value = data.evaluator1_name || '';
            document.getElementById('evaluator2_name').value = data.evaluator2_name || '';
            document.getElementById('experience_years').value = data.experience_years || '';
            document.getElementById('comments').value = data.comments || '';

            Object.keys(data).forEach(key => {
                const radio = document.querySelector(`input[name="${key}"][value="${data[key]}"]`);
                if (radio) radio.checked = true;
            });

            calculateScores();
            history.splice(index, 1);
            localStorage.setItem('evaluations', JSON.stringify(history));
            loadHistory();
            window.scrollTo(0, 0);
        };

        window.deleteEvaluation = function(index) {
            if (confirm('Ø­Ø°Ù Ø§ÛŒÙ† Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒØŸ')) {
                const history = JSON.parse(localStorage.getItem('evaluations') || '[]');
                history.splice(index, 1);
                localStorage.setItem('evaluations', JSON.stringify(history));
                loadHistory();
            }
        };

        document.getElementById('clear-all').addEventListener('click', () => {
            if (confirm('Ù‡Ù…Ù‡ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒâ€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´ÙˆØ¯ØŸ')) {
                localStorage.removeItem('evaluations');
                loadHistory();
            }
        });

        document.getElementById('save-and-pdf-btn').addEventListener('click', saveAndDownloadPDF);

        loadHistory();
        calculateScores();
    </script>
</body>
</html>
